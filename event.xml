% my ( $fault, $node_id, $hostname, $severity, $time ) = @_;
<log>
	<events>
		<event>
			<uei>uei.opennms.org/cisco-apic/fault/<%= $severity %></uei>
			<source>perl</source>
			<nodeid><%= $node_id %></nodeid>
			<time><%= $time %></time>
			<host><%= $hostname %></host>
			<parms>
			% for my $attr (keys $fault->attr) {
				<parm>
					<parmName><![CDATA[<%= $attr %>]]></parmName>
					<value type="string" encoding="text"><![CDATA[<%= $fault->attr->{$attr} %>]]></value>
				</parm>
			% }
			</parms>
			<descr>faultSummary event generated by Cisco APIC</descr>
			<logmsg>faultSummary event generated by Cisco APIC. All attributes encapsulated in parm.</logmsg>
			<severity><%= $severity %></severity>
			<operinstruct></operinstruct>
		</event>
	</events>
</log>

